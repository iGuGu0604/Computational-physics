# è®¡ç®—ç‰©ç†è¯¾åä½œä¸šï¼ˆäºŒï¼‰

## é—®é¢˜ï¼š

ä½¿ç”¨ä½ ä»¬è‡ªå·±ç”»çš„â€œèˆ¹â€å®ç°ä»æ¡†ä½“å·¦è¾¹é©¶å‘å³è¾¹ï¼ˆä¸Šé¢å·²æœ‰è½¦å­ç§»åŠ¨çš„ä»£ç ï¼Œé€‚å½“è°ƒæ•´æ»¡è¶³ä½ ä»¬è‡ªå·±çš„éœ€è¦ï¼‰ï¼Œé¢å¤–è¦æ±‚ï¼š

ï¼ˆ1ï¼‰å½“åœ¨æ¡†ä½“å†…éƒ¨ç‚¹å‡»é¼ æ ‡æ—¶ï¼Œèˆ¹å‡ºç°åœ¨é¼ æ ‡ç‚¹å‡»çš„åœ°æ–¹ï¼ˆä¸Šé¢ä¾‹å­é‡Œé¢å·²ç»æœ‰éƒ¨åˆ†ä»£ç ï¼Œä»”ç»†é˜…è¯»ï¼‰ï¼›

ï¼ˆ2ï¼‰å½“èˆ¹ç§»å‡ºæ¡†ä½“å³è¾¹æ—¶ï¼Œèˆ¹ä»æ¡†ä½“å·¦è¾¹é‡æ–°é©¶å…¥ï¼Œä¸€ç›´å¾ªç¯ï¼›

ï¼ˆ3ï¼‰ä»£ç è¦æ±‚æœ‰ä¹¦ä¸Šç¤ºèŒƒçš„æ³¨é‡Šæ–¹æ³•ï¼Œæœ€å¥½æŒ‰ç…§è¿™ç§æ–¹å¼è¿›è¡Œå¼€å‘ï¼Œç†Ÿç»ƒä»¥åå¯¹åç»­å¼€å‘å¾ˆæœ‰å¥½å¤„ã€‚

å°æŒ‘æˆ˜ï¼šå› ä¸ºå¤§å®¶ç”»çš„æ˜¯èˆ¹ï¼Œèˆ¹åœ¨æ°´ä¸Šè¿åŠ¨æ—¶æ˜¯ä¼šèµ·ä¼ï¼ˆä¸Šä¸‹è¿åŠ¨ï¼‰é¢ ç°¸ï¼ˆä¸€ç‚¹æ—‹è½¬ï¼‰ï¼Œå¯ä»¥åœ¨æ–¹æ¡†åº•éƒ¨ç”»ç‚¹â€œæ³¢æµªâ€ï¼Œè®©èˆ¹åœ¨ä¸Šé¢éšæ³¢é€æµ![ğŸ˜€](data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==)

## è¿‡ç¨‹å®ç°ä¸ä»£ç 

ç¨‹åºçš„è¿è¡Œè¦è°ƒç”¨ä¸¤ä¸ªpackageï¼š

```racket
(require 2htdp/image)
(require 2htdp/universe)
```



### è®¾ç½®èƒŒæ™¯

æŒ‰ç…§è¯¾å ‚å†…å®¹ä»¥åŠè¯¾æœ¬è¦æ±‚ï¼Œé¦–å…ˆå®šä¹‰*physical constant*ä¸*graphical constant*ï¼Œå¹¶ç”¨ä¹¦ä¸­çš„æ³¨é‡ŠåŒºåˆ†ä¸é—´éš”ï¼Œä»£ç å¦‚ä¸‹ï¼š

```Racket
;;;Definitions
;;Physical Constants;
(define WIDTH-OF-WORLD 420)
;;Graphical
;;THE BOAT
(require 2htdp/image)
(define HEIGHT-OF-BOTTOM 20)
(define a (triangle/ass 90  HEIGHT-OF-BOTTOM 30 "solid" "black"))
(define b (triangle/sas HEIGHT-OF-BOTTOM  90 30 "solid" "black"))
(define c (rectangle 10 HEIGHT-OF-BOTTOM  "solid" "black"))
(define hull-bottom (overlay/offset (overlay/offset c
                  -20 0
                   b)
                   35 0 a))
(define with-line (add-line hull-bottom 35 0 35 -40 "black"))
(define sail (right-triangle 20 30 "solid" "pink"))
;;The boat!!
(define BOAT (overlay/offset with-line
                  10 -15
                  sail))

;;Blacground
(define HEIGHT-OF-WORLD (* (image-height BOAT) 2))
(define SEA (rectangle WIDTH-OF-WORLD 30 "solid" "blue"))

(define BACKGROUND (place-image SEA (/ WIDTH-OF-WORLD 2) (- HEIGHT-OF-WORLD 15)
              (empty-scene WIDTH-OF-WORLD HEIGHT-OF-WORLD "skyblue" )))

(define Y-BOAT (- (- HEIGHT-OF-WORLD 20) (/ (image-height BOAT) 2)))
```

ä»ä»£ç çš„é•¿åº¦å°±èƒ½çŸ¥é“æ˜¯æœ´å®æ— åçš„å°èˆ¹å’ŒèƒŒæ™¯

### è®¾å®šåŠŸèƒ½

åœ¨Data Definitionä¸­

å®šä¹‰`(tock...)`è®¾ç½®äº†èˆ¹çš„é€Ÿåº¦ï¼Œæ¯éš”ä¸€ä¸ªclock tickå‰è¿›3ä¸ªåƒç´ ï¼Œå¹¶ç”¨`(cond ...)`åˆ¤æ–­å°èˆ¹æ˜¯å¦é©¶å‡ºæ¡†å¤–ä»è€Œå®ç°å¾ªç¯

å®šä¹‰`(render...)`å°†å°èˆ¹æ”¾åœ¨èƒŒæ™¯æ¿ä¸­

å®šä¹‰`(hyper...)`å®ç°é¼ æ ‡æ§åˆ¶å°èˆ¹ä½ç½®çš„åŠŸèƒ½

ç”¨`(check-expect...)`æ£€æŸ¥å„åŠŸèƒ½çš„è¿è¡Œæƒ…å†µ

```
;;;Data Definition
;;clock ticks
(check-expect (tock 89) 92)
(check-expect (tock 64) 67)
(check-expect (tock 500) 0)
(define (tock ws)
  (cond
    [(< ws (+ WIDTH-OF-WORLD (/ (image-width BOAT) 2))) (+ ws 3)]
    [(>= ws (+ WIDTH-OF-WORLD (/ (image-width BOAT) 2))) (- ws ws)]))

;; WorldState -> Image
;; place the car into the BACKGROUND scene,
;; according to the given world state
(check-expect (render  50) (place-image BOAT  50 Y-BOAT BACKGROUND))
(check-expect (render 200) (place-image BOAT 200 Y-BOAT BACKGROUND))

(define (render ws)
  (place-image BOAT ws Y-BOAT BACKGROUND))

;; WorldState Number Number String -> WorldState
;; places the car at the x-coordinate
;; if the given me is "button-down"

(check-expect (hyper 21 10 20 "enter") 21)
(check-expect (hyper 42 10 20 "button-down") 10)
(check-expect (hyper 42 10 20 "move") 42)

(define (hyper x-coordinate x-mouse y-mouse me)
  (cond
    [(string=? "button-down" me) x-mouse]
    [else  x-coordinate]))

```

### è¿è¡Œéƒ¨åˆ†

å®šä¹‰`(main...)`å¹¶è°ƒç”¨*big-bing*å¾—åˆ°å°èˆ¹åœ¨æµ·é¢ä¸Šè¿åŠ¨çš„å›¾åƒ

```
;; main : WorldState -> WorldState
;; launch the program from some initial state
;; run: (main 0)
(define (main ws)
   (big-bang ws
             [on-tick tock]
             [on-mouse hyper]
             [to-draw render]))

```

ç‚¹å‡»RUN å¹¶è¾“å…¥`(main 0)`è¿è¡Œç»“æœ



<img src="C:\Users\28153\Desktop\è®¡ç®—ç‰©ç†\ç¬¬äºŒæ¬¡ä½œä¸š\1.png" alt="1" style="zoom:50%;" />

<img src="C:\Users\28153\Desktop\è®¡ç®—ç‰©ç†\ç¬¬äºŒæ¬¡ä½œä¸š\3.png" alt="3" style="zoom:50%;" />

<img src="C:\Users\28153\Desktop\è®¡ç®—ç‰©ç†\ç¬¬äºŒæ¬¡ä½œä¸š\2.png" alt="2" style="zoom:50%;" />

## å°æŒ‘æˆ˜

ç”¨éšæœºæ•°å’Œ`(rotate...)`å®ç°å°èˆ¹çš„éšæ³¢é€æµ

### ä¿®æ”¹ä¸€ï¼šç”¨éšæœºæ•°ç”Ÿæˆå°èˆ¹çš„çºµåæ ‡å¹¶ä½¿å°èˆ¹å€¾æ–œ

```racket
(define (render ws)
  (place-image (rotate (* 180 (/ (atan (* 1 (- (random 2) 0.5)) 3) 3.1415)) BOAT-WITH-WAVE) ws (+ Y-BOAT (* 1 (- (random 2) 0.5))) BACKGROUND))
```

### ä¿®æ”¹äºŒï¼šæ·»åŠ æ³¢æµª

ç”±äºåœ¨åº•éƒ¨å¢åŠ æ›²çº¿æ— æ³•æ‹Ÿåˆå°èˆ¹çš„è¿åŠ¨è½¨è¿¹ï¼Œæ•…æ·»åŠ äº†æ³¢æµªå’Œæ¶Ÿæ¼ªä¸¤ç§æ•ˆæœï¼Œå¦‚å›¾æ‰€ç¤ºï¼š

<img src="file:///C:\Users\28153\Documents\Tencent Files\281536895\Image\C2C\Image1\MYPC0AJIQH4`KPYMTNGGGAH.png" alt="img" style="zoom:50%;" />

<img src="C:\Users\28153\Desktop\è®¡ç®—ç‰©ç†\ç¬¬äºŒæ¬¡ä½œä¸š\wave2.png" alt="wave2" style="zoom:50%;" />

<img src="C:\Users\28153\Desktop\è®¡ç®—ç‰©ç†\ç¬¬äºŒæ¬¡ä½œä¸š\WAVE3.png" alt="WAVE3" style="zoom:50%;" />

å®ç°ä»£ç å¦‚ä¸‹ï¼š

```
;;Blacground
(define HEIGHT-OF-WORLD (* (image-height BOAT) 2))
(define SEA (rectangle WIDTH-OF-WORLD 70 "solid" "blue"))
(define BACKGROUND (place-image SEA
                                (/ WIDTH-OF-WORLD 2) (- HEIGHT-OF-WORLD 35)
              (empty-scene WIDTH-OF-WORLD HEIGHT-OF-WORLD "skyblue" )))
(define BACKGROUND-WITH-WAVE
  (add-curve
  (add-curve
  (add-curve
  (add-curve 
  (add-curve BACKGROUND
             30 80 60 1/3
             90 80 60 1/3
             "Medium Cyan")
  120 70 60 1/3
             180 70 60 1/3
             "Medium Cyan")
  160 100 60 1/3
             220 100 60 1/3
             "Medium Cyan")
  240 75 60 1/3
             300 75 60 1/3
             "Medium Cyan")
  330 95 60 1/3
             390 95 60 1/3
             "Medium Cyan"))
 ï¼›ï¼›The Boat
 (define WAVE1 (polygon (list (make-pulled-point 1 5 60 0 1/2 -10)
                 (make-posn -10 20)
                 (make-pulled-point 1/2 -20 50 0 1/2 20)
                 (make-posn -2 -10))
           "solid"
           "white"))
(define WAVE2 (polygon (list (make-pulled-point 1 5 50 0 1/2 -10)
                 (make-posn -10 20)
                 (make-pulled-point 1/2 -20 50 0 1/2 20)
                 (make-posn -2 -10))
           "solid"
           "white"))
(define BOAT-WITH-WAVE
  (overlay/xy 
  (overlay/xy BOAT
              -5 50
              WAVE2)
  -16 50
  WAVE1))

```

### ä¿®æ”¹ä¸‰ï¼šæ”¹å˜clock tickå‡ä½å¸•é‡‘æ£®ç¨‹åº¦ï¼ˆæŒ¯åŠ¨é¢‘ç‡ï¼‰

å°±æ˜¯è®¾ç½®äº†`[on-tick...]`ä¸­çš„rateï¼Œä½¿clock ticksæ¬¡æ•°ä»æ¯ç§’28æ¬¡é™ä½åˆ°æ¯ç§’5æ¬¡ï¼Œç¼ºç‚¹æ˜¯æ”¹å˜äº†å¸§æ•°

```
[on-tick tock 1/5]
```

### å®Œæ•´ä»£ç 

```racket
(require 2htdp/image)
(require 2htdp/universe)
;;;Definitions
;;Physical Constants;
(define WIDTH-OF-WORLD 420)
;;Graphical
;;THE BOAT
(require 2htdp/image)
(define HEIGHT-OF-BOTTOM 20)
(define a (triangle/ass 90  HEIGHT-OF-BOTTOM 30 "solid" "black"))
(define b (triangle/sas HEIGHT-OF-BOTTOM  90 30 "solid" "black"))
(define c (rectangle 10 HEIGHT-OF-BOTTOM  "solid" "black"))
(define hull-bottom (overlay/offset (overlay/offset c
                  -20 0
                   b)
                   35 0 a))
(define with-line (add-line hull-bottom 35 0 35 -40 "black"))
(define sail (right-triangle 20 30 "solid" "pink"))
;;The boat!!
(define BOAT (overlay/offset with-line
                  10 -15
                  sail))

(define WAVE1 (polygon (list (make-pulled-point 1 5 60 0 1/2 -10)
                 (make-posn -10 20)
                 (make-pulled-point 1/2 -20 50 0 1/2 20)
                 (make-posn -2 -10))
           "solid"
           "white"))
(define WAVE2 (polygon (list (make-pulled-point 1 5 50 0 1/2 -10)
                 (make-posn -10 20)
                 (make-pulled-point 1/2 -20 50 0 1/2 20)
                 (make-posn -2 -10))
           "solid"
           "white"))
(define BOAT-WITH-WAVE
  (overlay/xy 
  (overlay/xy BOAT
              -5 50
              WAVE2)
  -16 50
  WAVE1))

;;Blacground
(define HEIGHT-OF-WORLD (* (image-height BOAT) 2))
(define SEA (rectangle WIDTH-OF-WORLD 70 "solid" "blue"))
(define BACKGROUND (place-image SEA
                                (/ WIDTH-OF-WORLD 2) (- HEIGHT-OF-WORLD 35)
              (empty-scene WIDTH-OF-WORLD HEIGHT-OF-WORLD "skyblue" )))
(define BACKGROUND-WITH-WAVE
  (add-curve
  (add-curve
  (add-curve
  (add-curve 
  (add-curve BACKGROUND
             30 80 60 1/3
             90 80 60 1/3
             "Medium Cyan")
  120 70 60 1/3
             180 70 60 1/3
             "Medium Cyan")
  160 100 60 1/3
             220 100 60 1/3
             "Medium Cyan")
  240 75 60 1/3
             300 75 60 1/3
             "Medium Cyan")
  330 95 60 1/3
             390 95 60 1/3
             "Medium Cyan"))
  
  
(define Y-BOAT (- (- HEIGHT-OF-WORLD 20) (/ (image-height BOAT) 2)))


;;;Data Definition

;;clock ticks
(check-expect (tock 89) 92)
(check-expect (tock 64) 67)
(check-expect (tock 500) 0)
(define (tock ws)
  (cond
    [(< ws (+ WIDTH-OF-WORLD (/ (image-width BOAT) 2))) (+ ws 3)]
    [(>= ws (+ WIDTH-OF-WORLD (/ (image-width BOAT) 2))) (- ws ws)]))

;; WorldState -> Image
;; place the car into the BACKGROUND scene,
;; according to the given world state

(define (render ws)
  (place-image (rotate (* 180 (/ (atan (* 1 (- (random 2) 0.5)) 3) 3.1415)) BOAT-WITH-WAVE) ws (+ Y-BOAT (* 1 (- (random 2) 0.5))) BACKGROUND-WITH-WAVE))

;; WorldState -> Boolean
;; end boat simulation when car reaches end of world
(check-expect (end? 0) #false)
(check-expect (end? 100) #false)
(check-expect (end? (+ WIDTH-OF-WORLD (/ (image-width BOAT) 2))) #true)

(define (end? ws)
  (>= ws (+ WIDTH-OF-WORLD (/ (image-width BOAT) 2))))


;; WorldState Number Number String -> WorldState
;; places the car at the x-coordinate
;; if the given me is "button-down"

(check-expect (hyper 21 10 20 "enter") 21)
(check-expect (hyper 42 10 20 "button-down") 10)
(check-expect (hyper 42 10 20 "move") 42)

(define (hyper x-coordinate x-mouse y-mouse me)
  (cond
    [(string=? "button-down" me) x-mouse]
    [else  x-coordinate]))


;; main : WorldState -> WorldState
;; launch the program from some initial state
;; run: (main 0)
(define (main ws)
   (big-bang ws
             [on-tick tock 1/5]
             [on-mouse hyper]
             [to-draw render]))
;(main 0)
```

## è‡´è°¢ä¸å­˜ç–‘

ç”Ÿæˆéšæœºæ•°æ—¶ï¼Œæ— æ³•åƒç½‘é¡µç¤ºä¾‹é‚£æ ·è¾“å…¥maxå’Œminä¸¤ä¸ªå‚æ•°ï¼Œè€Œæ˜¯åªèƒ½è¾“å…¥ä¸€ä¸ªå‚æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚å³ä½¿ç”¨`(require racket/base)`ä¹Ÿæ²¡æœ‰ç”¨ï¼ŒåŸå› æš‚ä¸æ˜ã€‚

æ„Ÿè°¢å¼ å­æ¶µåŒå­¦æä¾›çš„ç‚¹å­å®ç°äº†åœ¨`(-1,1)`é—´å–éšæœºæ•°ï¼š

```racket
(* 2 (- (random) 0.5))
```
